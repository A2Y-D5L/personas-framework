# Create Command Line Interface (CLI) Tool

**Created:** 2025-08-28  
**Priority:** MEDIUM  
**Assigned:** Engineer  
**Estimated Effort:** L  
**Dependencies:** 20250828-140400-implement-task-metadata-schema

## Objective

Create a unified command line interface tool that integrates all framework automation functionality into a single `personas` command.

## Target Location

**CLI Tool:** `/Users/andy/Dev/agents/personas-framework/bin/personas`
**Installation:** Make available in system PATH or as framework utility

## Acceptance Criteria

- [ ] Unified `personas` command with subcommands
- [ ] Integration with template generation, validation, and task management
- [ ] Clear help documentation and usage examples
- [ ] Error handling and user-friendly output
- [ ] Configuration file support
- [ ] Cross-platform compatibility (bash/shell script)

## Command Structure

**Main command with subcommands:**
```bash
personas <subcommand> [options] [arguments]
```

**Core Subcommands:**

### Project Management
```bash
# Initialize new project with personas framework
personas init <project-name> [options]

# Update existing project to latest template  
personas update [options]

# Validate project structure
personas validate [component] [options]
```

### Template Management
```bash
# Generate .personas directory from template
personas generate --target <path> --project-name <name> [options]

# Validate template structure
personas validate-template [template-path]
```

### Task Management
```bash
# Create new task
personas create-task <persona> <title> [options]

# Validate task files
personas validate-tasks [persona] [options]

# Check task dependencies
personas check-dependencies <task-id> [options]
```

### Persona Management
```bash
# Update persona definition
personas update-persona <persona> [options]

# Sync persona references
personas sync-references [options]

# List available personas
personas list-personas
```

## Implementation Structure

**Main CLI Script:**
```bash
#!/bin/bash
# Personas Framework CLI Tool
# Usage: personas <subcommand> [options]

set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
FRAMEWORK_ROOT="$(dirname "$SCRIPT_DIR")"

# Import utility functions
source "$FRAMEWORK_ROOT/tools/cli-utils.sh"

# Main command dispatcher
main() {
    case "${1:-}" in
        init)
            shift
            cmd_init "$@"
            ;;
        generate)
            shift
            cmd_generate "$@"
            ;;
        validate)
            shift
            cmd_validate "$@"
            ;;
        # ... other commands
        help|--help|-h)
            show_help
            ;;
        *)
            echo "Error: Unknown command '${1:-}'"
            show_help
            exit 1
            ;;
    esac
}

main "$@"
```

## Subcommand Implementation

**Example: personas init**
```bash
cmd_init() {
    local project_name=""
    local target_dir=""
    local description=""
    local tech_stack=""
    
    # Parse arguments
    while [[ $# -gt 0 ]]; do
        case $1 in
            --target)
                target_dir="$2"
                shift 2
                ;;
            --description)
                description="$2"
                shift 2
                ;;
            *)
                project_name="$1"
                shift
                ;;
        esac
    done
    
    # Validate arguments
    if [[ -z "$project_name" ]]; then
        echo "Error: Project name is required"
        exit 1
    fi
    
    # Set default target directory
    target_dir="${target_dir:-$project_name}"
    
    # Call template generation
    "$FRAMEWORK_ROOT/template/scripts/generate.sh" \
        --target "$target_dir" \
        --project-name "$project_name" \
        --description "$description" \
        --tech-stack "$tech_stack"
}
```

## Help System

**Main help output:**
```text
Personas Framework CLI Tool

Usage: personas <subcommand> [options]

Subcommands:
  init <name>              Initialize new project with personas framework
  generate                 Generate .personas directory from template
  update                   Update existing project structure
  validate [component]     Validate project structure and files
  
  create-task <persona>    Create new task for specified persona  
  validate-tasks          Validate task files and metadata
  check-dependencies      Check task dependency chains
  
  update-persona          Update persona definitions
  sync-references         Sync persona references to current versions
  list-personas           List available personas

Global Options:
  --config <file>         Use custom configuration file
  --verbose              Enable verbose output
  --dry-run              Show what would be done without executing
  --help                 Show this help message

Examples:
  personas init my-project --description "My new project"
  personas validate structure
  personas create-task engineer "Implement feature X" --priority high
  personas check-dependencies TASK-2025-001

For detailed help on a subcommand, use:
  personas <subcommand> --help
```

## Configuration Support

**Global config file: ~/.personas/config.yaml**
```yaml
framework:
  template_repository: "/path/to/personas-framework/template"
  default_template: "standard"

validation:
  strict_mode: true
  auto_fix_minor: true

output:
  format: "pretty"
  verbose: false
  colors: true
```

## Integration Points

**CLI integrates with existing tools:**
- `template/scripts/generate.sh` - Template generation
- `template/scripts/validate.sh` - Structure validation
- `tools/validate-tasks.sh` - Task validation
- `schemas/task-schema.yaml` - Task metadata validation

## Important Notes

- CLI provides unified interface to all framework functionality
- Maintains compatibility with existing individual scripts
- Should work from any directory (not just framework root)
- Clear error messages and help documentation
- Follows standard CLI conventions and patterns

## Definition of Done

- [ ] Unified `personas` command implemented
- [ ] All major subcommands functional
- [ ] Integration with existing tools working
- [ ] Comprehensive help system
- [ ] Configuration file support
- [ ] Error handling and user feedback
- [ ] Installation and usage documentation
- [ ] Cross-platform compatibility tested
